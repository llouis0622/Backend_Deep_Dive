## 9. 스프링 트랜잭션 이해

### 1. 트랜잭션 적용 위치
- 스프링 우선순위 : 더 구체적이고 자세한 것이 높은 우선순위를 가짐
  - 우선순위
  - 클래스에 적용 시 메서드는 자동 적용
- 인터페이스 @Transactional 적용
  - 클래스의 메서드
  - 클래스의 타입
  - 인터페이스의 메서드
  - 인터페이스의 타입

### 2. 트랜잭션 AOP 주의 사항 - 프록시 내부 호출 1
- 대상 객체의 내부에서 메서드 호출 발생 -> 프록시를 거치지 않고 대상 객체 직접 호출
- public 메서드만 트랜잭션 적용

### 3. 트랜잭션 AOP 주의 사항 - 초기화 시점
- value, transactionManager : 사용할 트랜잭션 매니저 지정
- rollbackFor : 예외 발생 시 스프링 트랜잭션 기본 정책
- noRollbackFor : 기본 정책에 추가로 어떤 예외가 발생했을 때 롤백하면 안되는지 지정
- propagation : 트랜잭션 전파 옵션
- isolation : 트랜잭션 격리 수준 지정
- timeout : 트랜잭션 수행 시간에 대한 타임아웃 초 단위로 지정
- label : 트랜잭션 어노테이션에 있는 값을 읽어서 어떤 동작을 하고 싶을 때 사용
- readOnly : 읽기 전용 트랜잭션 생성

### 4. 예외와 트랜잭션 커밋, 롤백
- 비즈니스 예외 : 비즈니스 상황이 예외인 것

## 10. 스프링 트랜잭션 전파 1 - 기본

### 1. 스프링 트랜잭션 전파 1 - 전파
- 트랜잭션 전파 : 어떻게 동작할지 결정하는 것
- 물리 트랜잭션 : 우리가 이해하는 실제 데이터베이스에 적용되는 트랜잭션
- 논리 트랜잭션 : 트랜잭션이 진행되는 중에 내부에 츠가로 트랜잭션을 사용하는 경우
- 모든 논리 트랜잭션이 커밋되어야 물리 트랜잭션이 커밋됨
- 하나의 논리 트랜잭션이라도 롤백되면 물리 트랜잭션은 롤백
- 외부 트랜잭션과 내부 트랜잭션이 하나의 물리 트랜잭션으로 묶임

### 2. 스프링 트랜잭션 전파 2 - REQUIRES_NEW
- 외부 트랜잭션과 내부 트랜잭션을 완전히 분리해서 각각 별도의 물리 트랜잭션을 사용하는 방법
- 물리 트랜잭션 분리 가능
- 데이터베이스 커넥션 동시에 2개 사용

### 3. 스프링 트랜잭션 전파 3 - 다양한 전파 옵션
- REQUIRED
  - 가장 많이 사용하는 기본 설정
  - 기존 트랜잭션 없음 -> 새로운 트랜잭션 생성
  - 기존 트랜잭션 있음 -> 기존 트랜잭션 참여
- REQUIRES_NEW
  - 항상 새로운 트랜잭션 생성
  - 기존 트랜잭션 없음 -> 새로운 트랜잭션 생성
  - 기존 트랜잭션 있음 -> 새로운 트랜잭션 생성
- SUPPORT
  - 트랜잭션 지원
  - 기존 트랜잭션 없음 -> 트랜잭션 없이 진행
  - 기존 트랜잭션 있음 -> 기존 트랜잭션 참여
- NOT_SUPPORT
  - 트랜잭션 미지원
  - 기존 트랜잭션 없음 -> 트랜잭션 없이 진행
  - 기존 트랜잭션 있음 -> 트랜잭션 없이 진행
- MANDATORY
  - 의무사항, 반드시 있어야 함
  - 기존 트랜잭션 없음 -> IllegalTransactionStateException 예외 발생
  - 기존 트랜잭션 있음 -> 기존 트랜잭션 참여
- NEVER
  - 트랜잭션 미사용
  - 기존 트랜잭션 없음 -> 트랜잭션 없이 진행
  - 기존 트랜잭션 있음 -> IllegalTransactionStateException 예외 발생
- NESTED
  - 기존 트랜잭션 없음 -> 새로운 트랜잭션 생성
  - 기존 트랜잭션 있음 -> 중첩 트랜잭션 생성

