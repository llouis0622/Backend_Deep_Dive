## 1. JPA 소개
- SQL 중심적인 개발의 문제점 : 무한 반복, 지루한 코드
- 객체를 자바 컬렉션에 저장하듯이 DB에 저장 -> JPA
- JPA(Java Persistence API) : 자바 진영의 ORM 기술 표준
- ORM(Object-Relational Mapping) : 객체 관계 매핑
  - 객체는 객체대로 설계
  - RDB는 RDB로 설계
  - ORN 프레임워크가 중간에서 매핑

## 2. JPA 시작
- Maven
  - 자바 라이브러리, 빌드 관리
  - 라이브러리 자동 다운로드 및 의존성 관라
  - Gradle이 점점 유명
- 엔티티 매니저 팩토리 : 하나만 생성, 어플리케이션 전체에서 공유
- 엔티티 매니저 : 쓰레드 간 공유 불가
- JPA 모든 데이터 변경 : 트랜잭션 안에서 실행

## 3. 영속성 관리
- 영속성 컨텍스트
  - JPA를 이해하는 데 가장 중요한 용어
  - 엔티티를 영구 저장하는 환경
  - EntityManager.persist(entity)
  - 엔티티 매니저를 통해 영속성 컨텍스트에 접근
  - 1차 캐시
  - 동일성 보장
  - 트랜잭션을 지원하는 쓰기 지연
  - 변경 감지
  - 지연 로딩
- 엔티티 생명주기
  - 비영속(new/transient) : 영속성 컨텍스트와 전혀 관계가 없는 새로운 상태
  - 영속(managed) : 영속성 컨텍스트에 관리되는 상태
  - 준영속(detached) : 영속성 컨텍스트에 저장되었다가 분리된 상태
  - 삭제(removed) : 삭제된 상태
- 플러시
  - 영속성 컨텍스트의 변경내용을 데이터베이스에 반영
  - 영속성 컨텍스트 비우지 않음
  - 트랜잭션 중요 -> 커밋 직전에만 동기화

## 4. 엔티티 매핑
- 객체와 테이블 매핑 : @Entity
  - 엔티티
  - 기본 생성자 필수
  - final, enum, interface, inner class 불가
  - 저장할 필드에 final 불가
  - 클래스 이름 그대로 사용
  - @Table : 엔티티 매핑할 테이블 지정
- 매핑 어노테이션
  - @Column : 컬럼
  - @Temporal : 날짜 타입
  - @Enumerated : enum 타입
  - @Lob : BLOB, CLOB
  - @Transient : 특정 필드를 컬럼에 매핑하지 않음

## 5. 연관관계 매핑 기초
- 단방향 연관관계
  - 객체 연관관계 사용
  - 객체의 참조와 테이블의 외래 키 매핑
  - ORM 매핑
  - 연관관계 저장
- 양방향 연관관계
  - 역방향 조회 가능
  - 서로 다른 단방향 관계 2개

## 6. 다양한 연관관계 매핑
- 연관관계 매핑 시 고려사항
  - 다중성 : 다대일, 일대다, 일대일, 다대다
  - 단방햐아 양방향 : 테이블, 객체
  - 연관관계 주인
- 다대일
  - 가장 많이 사용하는 연관관계
  - 외래 키가 있는 쪽이 연관관계 주인
  - 양쪽을 서로 참조하도록 개발
- 일대다
  - 일이 연관관계 주인 -> 단방향
  - 다대일 양방향
- 일대일
  - 주 테이블에 외래 키, 대상 테이블에 외래 키
  - 다대일 단방향 매핑과 유사
  - 외래 키가 있는 곳이 연관관계 주인
  - 단방향 JPA 지원 X, 양방향 지원
- 다대다
  - 연결 테이블 추가
  - 편리해 보이지만 실무에서 사용 안함

## 7. 고급 매핑
- 상속관계 매핑
  - 관계형 데이터베이스 -> 상속 관계 X
  - 슈퍼타입 서브타입 관계 모델링 기법
  - 각각 테이블로 변환 -> 조인 전략
  - 통합 테이블로 변환 -> 단일 테이블 전략
  - 서브타입 테이블로 변환 -> 구현 클래스마다 테이블 전략

## 8. 프록시와 연관관계 정리
- 프록시
  - 실제 클래스를 상속 받아 만들어짐
  - 실제 클래스와 겉 모양 동일
  - 진짜 객체인지 프록시 객체인지 구분하지 않고 사용
  - 실제 객체의 참조 보관
  - 프록시 객체 -> 실제 객체의 메소드 호출
  - 처음 사용 시 한 번만 초기화
- 지연 로딩
  - 가급적 지연 로딩만 사용
  - 모든 연관관계에 지연 로딩 사용
- 고아 객체
  - 부모 엔티티와 연관관계가 끊어진 자식 엔티티를 자동으로 삭제
  - 참조하는 곳이 하나일 때 사용

## 9. 값 타입
- 엔티티 타입 : 데이터가 변해도 식별자로 지속해서 추적 가능
- 값 타입 : 식별자가 없고 값만 존재, 변경 시 추적 불가
- 기본값 타입 : 자바 기본 타입, 래퍼 클래스, String
- 임베디드 타입
- 컬렉션 값 타입